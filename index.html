<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Password Generator — lalaaluv</title>
  <style>
    :root{
      --bg:#000;
      --card:#0b0b0b;
      --muted:#9aa0a6;
      --accent:#ffdd00; /* yellow */
      --glass: rgba(255,255,255,0.02);
      --success: #4ade80;
      --danger: #ff6b6b;
      --mono: 'Segoe UI Mono', 'Roboto Mono', monospace;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:linear-gradient(180deg,#000 0%, #070707 100%);
      color: #e6e6e6;
      font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      display:flex;align-items:center;justify-content:center;padding:28px;
    }

    .container{
      width:100%;max-width:920px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.03);
      padding:22px;border-radius:16px;box-shadow:0 8px 30px rgba(0,0,0,0.6);
    }

    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    h1{margin:0;font-size:20px}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    .card{background:var(--card);padding:16px;border-radius:12px;margin-top:16px;border:1px solid rgba(255,255,255,0.02)}

    .row{display:flex;gap:12px;align-items:center}
    .col{flex:1}

    .output{
      font-family:var(--mono);font-size:18px;padding:12px;border-radius:10px;background:var(--glass);display:flex;align-items:center;gap:8px;justify-content:space-between;border:1px dashed rgba(255,255,255,0.03)
    }
    .output .pw{word-break:break-all;color:#fff}

    button.btn{
      background:var(--accent);border:none;color:#000;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600;box-shadow:0 6px 18px rgba(255,221,0,0.12);
    }
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:8px 10px;border-radius:8px}

    .controls{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:12px}
    label.switch{display:flex;align-items:center;gap:10px}
    input[type=range]{width:100%}
    .small{font-size:13px;color:var(--muted)}

    .strength{display:flex;align-items:center;gap:12px;margin-top:10px}
    .meter{height:10px;background:rgba(255,255,255,0.04);border-radius:12px;flex:1;overflow:hidden}
    .meter > i{display:block;height:100%;width:0%;background:linear-gradient(90deg,var(--danger),var(--accent));transition:width .3s ease}

    .meta{display:flex;gap:12px;align-items:center;margin-top:12px}
    .chip{background:rgba(255,255,255,0.02);padding:8px 10px;border-radius:999px;font-size:13px}

    footer{margin-top:18px;text-align:center;color:var(--muted);font-size:13px}

    .row-buttons{display:flex;gap:8px}
    .options{display:flex;flex-direction:column;gap:8px}

    @media (max-width:640px){
  body{padding:12px;}
  .container{padding:16px;width:100%;}
  h1{font-size:18px}
  .lead{font-size:12px}
  .controls{grid-template-columns:1fr}
  .row{flex-direction:column;align-items:stretch}
  .row-buttons{flex-wrap:wrap}
  .output{font-size:16px;padding:10px}
}.row{flex-direction:column;align-items:stretch}.row-buttons{flex-wrap:wrap}}
  </style>
</head>
<body>
  <div class="container" role="application">
    <header>
      <div>
        <h1>Password Generator</h1>
        <p class="lead">Generator kata sandi cepat & aman — tema dark • tombol kuning</p>
      </div>
      <div style="text-align:right;min-width:160px">
        <small class="small">Generated with ♥ by <strong>lalaaluv</strong></small>
      </div>
    </header>

    <div class="card" aria-live="polite">
      <div class="row">
        <div class="col">
          <div class="output" id="output">
            <div class="pw" id="password">—</div>
            <div style="display:flex;gap:8px;align-items:center">
              <button class="ghost" id="toggleShow" title="Tampilkan/ Sembunyikan">Show</button>
              <button class="btn" id="copyBtn" title="Salin ke clipboard">Salin</button>
            </div>
          </div>
        </div>
      </div>

      <div class="controls">
        <div>
          <label class="small">Panjang (8–128): <strong id="lenVal">16</strong></label>
          <input type="range" id="length" min="8" max="128" value="16" />
        </div>

        <div class="options">
          <label class="switch"><input type="checkbox" id="lower" checked /> <span class="small">Huruf kecil (a–z)</span></label>
          <label class="switch"><input type="checkbox" id="upper" checked /> <span class="small">Huruf besar (A–Z)</span></label>
          <label class="switch"><input type="checkbox" id="numbers" checked /> <span class="small">Angka (0–9)</span></label>
          <label class="switch"><input type="checkbox" id="symbols" checked /> <span class="small">Simbol (!@#$...)</span></label>
        </div>

        <div>
          <label class="switch"><input type="checkbox" id="excludeSimilar" /> <span class="small">Kecualikan karakter mirip (O,0,l,1,i)</span></label>
          <label class="switch"><input type="checkbox" id="avoidAmbig" /> <span class="small">Hanya simbol aman</span></label>
          <label class="switch"><input type="checkbox" id="includeSpaces" /> <span class="small">Sertakan spasi (jika diizinkan)</span></label>
          <label class="switch"><input type="checkbox" id="pronounceable" /> <span class="small">Buat mudah diucapkan (mengurangi entropi)</span></label>
        </div>

        <div>
          <div style="display:flex;gap:8px;align-items:center">
            <div class="row-buttons">
              <button id="generate" class="btn">Generate</button>
              <button id="download" class="ghost">Download .txt</button>
              <button id="copyAll" class="ghost">Salin semua</button>
            </div>
          </div>
          <div class="small" style="margin-top:8px;color:var(--muted)">Tekan Generate untuk membuat kata sandi baru</div>
        </div>
      </div>

      <div class="strength">
        <div class="meter" aria-hidden="true"><i id="meterFill"></i></div>
        <div class="chip" id="strengthText">—</div>
      </div>

      <div class="meta">
        <div class="chip">Entropy: <strong id="entropy">—</strong> bits</div>
        <div class="chip">Charset: <span id="charset">—</span></div>
      </div>

    </div>

    <footer>
      <div>Hak Cipta • lalaaluv</div>
    </footer>
  </div>

  <script>
    // Helper char sets
    const sets = {
      lower: 'abcdefghijklmnopqrstuvwxyz',
      upper: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
      numbers: '0123456789',
      symbols: '!@#$%^&*()_+[]{}|;:,.<>?/~`-=' // many symbols
    };

    const safeSymbols = '!@#$%&*+-='; // smaller safe set
    const similar = /[O0Il1]/g;

    // Elements
    const lengthEl = document.getElementById('length');
    const lenVal = document.getElementById('lenVal');
    const passwordEl = document.getElementById('password');
    const copyBtn = document.getElementById('copyBtn');
    const copyAll = document.getElementById('copyAll');
    const generateBtn = document.getElementById('generate');
    const meterFill = document.getElementById('meterFill');
    const strengthText = document.getElementById('strengthText');
    const entropyEl = document.getElementById('entropy');
    const charsetEl = document.getElementById('charset');
    const downloadBtn = document.getElementById('download');
    const toggleShow = document.getElementById('toggleShow');

    const inputs = {
      lower: document.getElementById('lower'),
      upper: document.getElementById('upper'),
      numbers: document.getElementById('numbers'),
      symbols: document.getElementById('symbols'),
      excludeSimilar: document.getElementById('excludeSimilar'),
      avoidAmbig: document.getElementById('avoidAmbig'),
      includeSpaces: document.getElementById('includeSpaces'),
      pronounceable: document.getElementById('pronounceable'),
    };

    // Init
    lenVal.textContent = lengthEl.value;

    lengthEl.addEventListener('input', ()=>{lenVal.textContent = lengthEl.value});

    function buildCharset(){
      let cs = '';
      if(inputs.lower.checked) cs += sets.lower;
      if(inputs.upper.checked) cs += sets.upper;
      if(inputs.numbers.checked) cs += sets.numbers;
      if(inputs.symbols.checked) cs += (inputs.avoidAmbig.checked ? safeSymbols : sets.symbols);
      if(inputs.includeSpaces.checked) cs += ' ';
      if(inputs.excludeSimilar.checked) cs = cs.replace(similar, '');
      // Remove duplicates
      cs = Array.from(new Set(cs.split(''))).join('');
      return cs;
    }

    function calculateEntropy(charsetLength, pwLength){
      if(charsetLength<=1 || pwLength<=0) return 0;
      return +(Math.log2(charsetLength) * pwLength).toFixed(2);
    }

    function strengthLabel(bits){
      if(bits<=28) return {text:'Lemah', pct:20};
      if(bits<=35) return {text:'Sedang', pct:45};
      if(bits<=59) return {text:'Kuat', pct:70};
      return {text:'Sangat Kuat', pct:100};
    }

    // Pronounceable generator (simple) -- reduces entropy but easier to remember
    function pronounceable(len){
      const vowels = 'aeiou';
      const consonants = 'bcdfghjklmnpqrstvwxyz';
      let out = '';
      for(let i=0;i<len;i++){
        if(i%2===0) out += consonants[Math.floor(Math.random()*consonants.length)];
        else out += vowels[Math.floor(Math.random()*vowels.length)];
      }
      return out;
    }

    function secureRandomInt(max){
      // returns integer in [0, max)
      const array = new Uint32Array(1);
      window.crypto.getRandomValues(array);
      return array[0] % max;
    }

    function generatePassword(){
      const len = parseInt(lengthEl.value,10);
      const cs = buildCharset();
      if(cs.length===0){
        alert('Pilih set karakter minimal satu (huruf/angka/simbol)');
        return '';
      }

      let pw = '';
      if(inputs.pronounceable.checked){
        pw = pronounceable(len);
      } else {
        for(let i=0;i<len;i++){
          const idx = secureRandomInt(cs.length);
          pw += cs.charAt(idx);
        }
      }
      // show
      passwordEl.textContent = pw;

      // entropy
      const ent = calculateEntropy(cs.length, pw.length);
      entropyEl.textContent = ent;
      charsetEl.textContent = cs.length + ' chars';

      const label = strengthLabel(ent);
      strengthText.textContent = label.text;
      meterFill.style.width = label.pct + '%';

      return pw;
    }

    generateBtn.addEventListener('click', ()=>{generatePassword();});

    copyBtn.addEventListener('click', async ()=>{
      const pw = passwordEl.textContent;
      if(!pw || pw==='—') return;
      try{
        await navigator.clipboard.writeText(pw);
        copyBtn.textContent = 'Disalin ✓';
        setTimeout(()=>copyBtn.textContent='Salin',1200);
      }catch(e){
        alert('Gagal menyalin: ' + e.message);
      }
    });

    copyAll.addEventListener('click', async ()=>{
      // copies generated pw + metadata
      const pw = passwordEl.textContent;
      if(!pw || pw==='—') return;
      const text = `Password: ${pw}\nPanjang: ${lengthEl.value}\nEntropy: ${entropyEl.textContent} bits`;
      try{
        await navigator.clipboard.writeText(text);
        copyAll.textContent = 'Disalin ✓';
        setTimeout(()=>copyAll.textContent='Salin semua',1200);
      }catch(e){alert('Gagal menyalin: '+e.message)}
    });

    downloadBtn.addEventListener('click', ()=>{
      const pw = passwordEl.textContent;
      if(!pw || pw==='—') return;
      const blob = new Blob([`Password: ${pw}\nPanjang: ${lengthEl.value}\nEntropy: ${entropyEl.textContent} bits`],{type:'text/plain'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'password.txt'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    toggleShow.addEventListener('click', ()=>{
      if(toggleShow.textContent.toLowerCase().includes('show')){
        passwordEl.style.webkitTextSecurity = 'none';
        toggleShow.textContent = 'Hide';
      } else {
        passwordEl.style.webkitTextSecurity = 'disc';
        toggleShow.textContent = 'Show';
      }
    });

    // initial gen
    window.addEventListener('load', ()=>{
      // mask by default
      passwordEl.style.webkitTextSecurity = 'disc';
      generatePassword();
    });

  </script>
</body>
</html>
